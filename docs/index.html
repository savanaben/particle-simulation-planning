<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Particle Collision Simulator</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Particle <span>Collision</span> Simulator</h1>
            <p class="subtitle">NO<sub>2</sub> + NO<sub>2</sub> → N<sub>2</sub>O<sub>4</sub> Pre-calculated Animation</p>
        </header>

        <div class="main-content">
            <div class="control-panel">
                <h2>Animation Mode</h2>

                <div class="control-group">
                    <button class="btn btn-primary" id="modeCustom" style="margin-bottom: 8px;">Custom Mode</button>
                    <button class="btn btn-primary" id="modeTemp25Particles15" style="margin-bottom: 8px;">Temp = 25 / Particles = 15</button>
                    <button class="btn btn-primary" id="modeTemp5Particles15" style="margin-bottom: 8px;">Temp = 5 / Particles = 15</button>
                    <button class="btn btn-primary" id="modeTemp25Particles10" style="margin-bottom: 8px;">Temp = 25 / Particles = 10</button>
                    <button class="btn btn-primary" id="modeTemp5Particles10" style="margin-bottom: 8px;">Temp = 5 / Particles = 10</button>
                    <button class="btn btn-primary" id="modeTemp15Particles15" style="margin-bottom: 8px;">Temp = 15 / Particles = 15</button>
                    <button class="btn btn-primary" id="modeTemp15Particles10" style="margin-bottom: 8px;">Temp = 15 / Particles = 10</button>
                </div>

                <div class="divider"></div>

                <h2>Parameters</h2>

                <div class="control-group">
                    <label>
                        Container Size
                        <span class="value"><span id="containerSizeValue">300</span> × <span id="containerSizeValue2">300</span> px</span>
                    </label>
                    <input type="range" id="containerSize" min="200" max="500" value="300" step="10">
                </div>

                <div class="control-group" id="numParticlesGroup">
                    <label>
                        NO<sub>2</sub> Particles
                        <span class="value" id="numParticlesValue">15</span>
                    </label>
                    <input type="range" id="numParticles" min="4" max="15" value="15">
                </div>

                <div class="control-group" id="numCollisionsGroup">
                    <label>
                        Collisions
                        <span class="value" id="numCollisionsValue">6</span>
                    </label>
                    <input type="range" id="numCollisions" min="1" max="7" value="6">
                </div>

                <div class="control-group">
                    <label>
                        Particle Speed
                        <span class="value"><span id="particleSpeedValue">80</span> px/s</span>
                    </label>
                    <input type="range" id="particleSpeed" min="30" max="200" value="80" step="10">
                </div>

                <div class="control-group">
                    <label>
                        Animation Duration
                        <span class="value"><span id="animationDurationValue">8</span> s</span>
                    </label>
                    <input type="range" id="animationDuration" min="4" max="20" value="8" step="1">
                </div>

                <div class="control-group">
                    <label>
                        Start Rest Period
                        <span class="value"><span id="startRestValue">0</span> s</span>
                    </label>
                    <input type="range" id="startRest" min="0" max="10" value="0" step="0.5">
                </div>

                <div class="control-group">
                    <label>
                        End Rest Period
                        <span class="value"><span id="endRestValue">0</span> s</span>
                    </label>
                    <input type="range" id="endRest" min="0" max="10" value="0" step="0.5">
                </div>

                <div class="control-group">
                    <label>Seed (optional)</label>
                    <input type="number" id="randomSeed" placeholder="Leave empty for random">
                </div>

                <div class="divider"></div>

                <button class="btn btn-primary" id="runBtn">Load Simulation</button>

                <div id="errorMessage" class="error-message" style="display: none;"></div>
            </div>

            <div class="canvas-area">
                <div class="canvas-header">
                    <h2>Simulation Preview</h2>
                    <div class="time-display">
                        <span id="currentTime">0.00</span>s / <span id="totalTime">8.00</span>s
                    </div>
                </div>

                <div class="canvas-wrapper">
                    <canvas id="simulationCanvas" width="300" height="300"></canvas>
                </div>

                <div class="progress-bar" id="progressBar">
                    <div class="progress-bar-fill" id="progressFill"></div>
                </div>

                <div class="playback-controls">
                    <button id="playPauseBtn">▶ Play</button>
                    <button id="restartBtn">↺ Restart</button>
                    <button id="stepBtn">⏭ Step</button>

                    <div class="speed-control">
                        <label>Speed: <span id="playbackSpeedValue">1</span>x</label>
                        <input type="range" id="playbackSpeed" min="0.25" max="3" value="1" step="0.25">
                    </div>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-dot no2"></div>
                        <span>NO<sub>2</sub></span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot n2o4"></div>
                        <span>N<sub>2</sub>O<sub>4</sub></span>
                    </div>
                </div>

                <div class="stats">
                    <div class="stat-box no2">
                        <div class="value" id="activeNo2">0</div>
                        <div class="label">Active NO<sub>2</sub></div>
                    </div>
                    <div class="stat-box n2o4">
                        <div class="value" id="activeN2o4">0</div>
                        <div class="label">Active N<sub>2</sub>O<sub>4</sub></div>
                    </div>
                    <div class="stat-box collisions">
                        <div class="value" id="collisionCount">0</div>
                        <div class="label">Events</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Tables Section -->
        <div class="data-section" id="dataSection">
            <h2>Animation <span>Keyframe Data</span></h2>

            <div class="collision-table-wrapper">
                <h3>Collision & Split Events</h3>
                <p class="time-format-note">Time format: seconds:frames (60fps). Click time cells to copy.</p>
                <table class="data-table" id="collisionTable">
                    <thead>
                        <tr>
                            <th>Time (s:f)</th>
                            <th>Position (x, y)</th>
                            <th>Particles Destroyed</th>
                            <th></th>
                            <th>Particle Created</th>
                        </tr>
                    </thead>
                    <tbody id="collisionTableBody">
                    </tbody>
                </table>
            </div>

            <div class="trajectories-wrapper">
                <h3>Particle Trajectories</h3>
                <button class="copy-btn" id="copyAllBtn">Copy All Data as CSV</button>
                <div id="particleTrajectories">
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
